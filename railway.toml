# OpenClaw Railway 部署配置

[build]
  builder = "dockerfile"

[deploy]
  startCommand = "node openclaw.mjs gateway --allow-unconfigured --auth token --token aE8D17b2aef960C736De1cDFDdc4806d314e2C2DebDedAe84A832fdbDefAEC7A --bind lan --port ${PORT} --verbose"
  restartPolicyType = "always"
  restartPolicyMaxRetries = 10

[env]
  NODE_ENV = "production"
  MODEL_NAME = "anthropic/claude-opus-4.5"
  OAUTH_ENABLED = "true"
  GATEWAY_AUTH_MODE = "token"
  # 令牌认证 - 使用正确的环境变量格式
  GATEWAY_TOKEN = "aE8D17b2aef960C736De1cDFDdc4806d314e2C2DebDedAe84A832fdbDefAEC7A"
  # Gateway 配置 - 使用正确的环境变量格式
  GATEWAY_TRUSTED_PROXIES = "100.64.0.0/10"
  GATEWAY_BIND = "lan"
  # 修复端口配置问题 - OpenClaw 使用 OPENCLAW_GATEWAY_PORT 环境变量
  OPENCLAW_GATEWAY_PORT = "${PORT}"
  SANDBOX_MODE = "non-main"
  DM_SCOPE = "per-peer"
  OPENCLAW_STATE_DIR = "/tmp/openclaw"
  OPENCLAW_WORKSPACE_DIR = "/tmp/workspace"
  # 修复权限问题
  HOME = "/tmp/openclaw"
  USER = "root"
  # 确保服务监听在所有接口
  BIND_ADDRESS = "0.0.0.0"
  # 确保配置文件使用正确的端口
  OPENCLAW_CONFIG_PATH = "/tmp/openclaw/openclaw.json"